<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP32 - AirTag Documentation: scanner/scanner.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP32 - AirTag Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('scanner_8ino.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">scanner.ino File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>ESP32 BLE Central with RFID and LCD UI.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;freertos/queue.h&quot;</code><br />
<code>#include &lt;BLEDevice.h&gt;</code><br />
<code>#include &lt;BLEUtils.h&gt;</code><br />
<code>#include &lt;BLEClient.h&gt;</code><br />
<code>#include &lt;BLEScan.h&gt;</code><br />
<code>#include &lt;LiquidCrystal_I2C.h&gt;</code><br />
<code>#include &lt;Wire.h&gt;</code><br />
<code>#include &lt;SPI.h&gt;</code><br />
<code>#include &lt;MFRC522.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_b_l_e_scanner_8h_source.html">BLEScanner.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="distance_8h_source.html">distance.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a445125ee8c34695376c85f10b38844d6" id="r_a445125ee8c34695376c85f10b38844d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a445125ee8c34695376c85f10b38844d6">SERVICE_UUID</a>&#160;&#160;&#160;&quot;275dc6e0-dff5-4b56-9af0-584a5768a02a&quot;</td></tr>
<tr class="memitem:afe874f71a08a3f462cb89a768e2a43e2" id="r_afe874f71a08a3f462cb89a768e2a43e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe874f71a08a3f462cb89a768e2a43e2">BUTTON_CHAR_UUID</a>&#160;&#160;&#160;&quot;b51bd845-2910-4f84-b062-d297ed286b1f&quot;</td></tr>
<tr class="memitem:ad5ef132e7e580fbe574f6cf357becb2e" id="r_ad5ef132e7e580fbe574f6cf357becb2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5ef132e7e580fbe574f6cf357becb2e">IMU_CHAR_UUID</a>&#160;&#160;&#160;&quot;0679c389-0d92-4604-aac4-664c43a51934&quot;</td></tr>
<tr class="memitem:ab61d0981ed42df9e18211b273d22cfcd" id="r_ab61d0981ed42df9e18211b273d22cfcd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab61d0981ed42df9e18211b273d22cfcd">BUZZER_PIN</a>&#160;&#160;&#160;42</td></tr>
<tr class="memitem:a08bca59db4b190eaaea4d47b7562869c" id="r_a08bca59db4b190eaaea4d47b7562869c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08bca59db4b190eaaea4d47b7562869c">RESET_PIN</a>&#160;&#160;&#160;41</td></tr>
<tr class="memitem:a326fc861b95f600798f492bd65a5caed" id="r_a326fc861b95f600798f492bd65a5caed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a326fc861b95f600798f492bd65a5caed">RFID_PIN</a>&#160;&#160;&#160;40</td></tr>
<tr class="memitem:a6a1a3e97267377d1b18bb9073192fdf1" id="r_a6a1a3e97267377d1b18bb9073192fdf1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a1a3e97267377d1b18bb9073192fdf1">PIN_SCK</a>&#160;&#160;&#160;13</td></tr>
<tr class="memitem:a46bdd417480dec5cb9cf196af3c7489c" id="r_a46bdd417480dec5cb9cf196af3c7489c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46bdd417480dec5cb9cf196af3c7489c">PIN_MISO</a>&#160;&#160;&#160;11</td></tr>
<tr class="memitem:abaeddda4b992af7165ed898ab8b2b4ac" id="r_abaeddda4b992af7165ed898ab8b2b4ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abaeddda4b992af7165ed898ab8b2b4ac">PIN_MOSI</a>&#160;&#160;&#160;12</td></tr>
<tr class="memitem:ab4b553591a495409d4f7cec4b6c3e754" id="r_ab4b553591a495409d4f7cec4b6c3e754"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4b553591a495409d4f7cec4b6c3e754">PIN_SS</a>&#160;&#160;&#160;14</td></tr>
<tr class="memitem:a0010d60e4eaa7f589cd190c45dcc7d20" id="r_a0010d60e4eaa7f589cd190c45dcc7d20"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0010d60e4eaa7f589cd190c45dcc7d20">PIN_RST</a>&#160;&#160;&#160;10</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a366bf7d724e74382df3a70cbfcf4cf9d" id="r_a366bf7d724e74382df3a70cbfcf4cf9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a366bf7d724e74382df3a70cbfcf4cf9d">BLEScannerTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a366bf7d724e74382df3a70cbfcf4cf9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to scan for BLE peripherals.  <br /></td></tr>
<tr class="memitem:ace8b2fe642b7289d51edb712ab27f86b" id="r_ace8b2fe642b7289d51edb712ab27f86b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace8b2fe642b7289d51edb712ab27f86b">distanceTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:ace8b2fe642b7289d51edb712ab27f86b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to compute distance from RSSI.  <br /></td></tr>
<tr class="memitem:ae38cff9bb8d4b8b7bfff8fb8b68ffb77" id="r_ae38cff9bb8d4b8b7bfff8fb8b68ffb77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae38cff9bb8d4b8b7bfff8fb8b68ffb77">UITask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:ae38cff9bb8d4b8b7bfff8fb8b68ffb77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to update LCD UI.  <br /></td></tr>
<tr class="memitem:a1f2482e5e4403590a79f1bb1eaedcbea" id="r_a1f2482e5e4403590a79f1bb1eaedcbea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f2482e5e4403590a79f1bb1eaedcbea">buttonTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a1f2482e5e4403590a79f1bb1eaedcbea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to handle button input.  <br /></td></tr>
<tr class="memitem:ab3b8593e304b021095698adac2b7f217" id="r_ab3b8593e304b021095698adac2b7f217"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3b8593e304b021095698adac2b7f217">RFIDTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:ab3b8593e304b021095698adac2b7f217"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to handle RFID scanning and authorization.  <br /></td></tr>
<tr class="memitem:a78aea0b783dee7e793220e19bf94eea9" id="r_a78aea0b783dee7e793220e19bf94eea9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78aea0b783dee7e793220e19bf94eea9">resetButtonTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a78aea0b783dee7e793220e19bf94eea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to reset RFID and lock system.  <br /></td></tr>
<tr class="memitem:ae084e1bc8ccb35ea289ba0ca4972ea6d" id="r_ae084e1bc8ccb35ea289ba0ca4972ea6d"><td class="memItemLeft" align="right" valign="top">LiquidCrystal_I2C&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae084e1bc8ccb35ea289ba0ca4972ea6d">lcd</a> (0x27, 16, 2)</td></tr>
<tr class="memitem:a7c2f79e6d9d3ac306c0daed213e162a4" id="r_a7c2f79e6d9d3ac306c0daed213e162a4"><td class="memItemLeft" align="right" valign="top">MFRC522&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c2f79e6d9d3ac306c0daed213e162a4">rfid</a> (<a class="el" href="#ab4b553591a495409d4f7cec4b6c3e754">PIN_SS</a>, <a class="el" href="#a0010d60e4eaa7f589cd190c45dcc7d20">PIN_RST</a>)</td></tr>
<tr class="memitem:ada1331884e2cfbe181532b4833c2bb78" id="r_ada1331884e2cfbe181532b4833c2bb78"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada1331884e2cfbe181532b4833c2bb78">isAuthorized</a> ()</td></tr>
<tr class="memdesc:ada1331884e2cfbe181532b4833c2bb78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if RFID UID is authorized.  <br /></td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d" id="r_a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arduino setup function. Initializes queues, peripherals, tasks, and starts FreeRTOS.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a467e28ac5652806c01ab750112413fb1" id="r_a467e28ac5652806c01ab750112413fb1"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a467e28ac5652806c01ab750112413fb1">UITaskHandle</a></td></tr>
<tr class="memitem:a2da550aadcbf5e6024b7395ad66fbcd2" id="r_a2da550aadcbf5e6024b7395ad66fbcd2"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2da550aadcbf5e6024b7395ad66fbcd2">ButtonTaskHandle</a></td></tr>
<tr class="memitem:a7bc035b6b02d12aad4f989c47ce95ce3" id="r_a7bc035b6b02d12aad4f989c47ce95ce3"><td class="memItemLeft" align="right" valign="top">TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bc035b6b02d12aad4f989c47ce95ce3">RFIDTaskHandle</a></td></tr>
<tr class="memitem:a36a62ed2995d8a4c80ea910f4e62c792" id="r_a36a62ed2995d8a4c80ea910f4e62c792"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36a62ed2995d8a4c80ea910f4e62c792">IMUQ</a></td></tr>
<tr class="memitem:afc318e3b04b7bf8f6fecc08ac6a0a39a" id="r_afc318e3b04b7bf8f6fecc08ac6a0a39a"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc318e3b04b7bf8f6fecc08ac6a0a39a">RSSIQ</a></td></tr>
<tr class="memitem:aaa747d1be9fe26dc539f6b760aa40577" id="r_aaa747d1be9fe26dc539f6b760aa40577"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa747d1be9fe26dc539f6b760aa40577">disQ</a></td></tr>
<tr class="memitem:a8e83540e3203f0d452453786a5911874" id="r_a8e83540e3203f0d452453786a5911874"><td class="memItemLeft" align="right" valign="top">QueueSetHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e83540e3203f0d452453786a5911874">uiSet</a> = nullptr</td></tr>
<tr class="memitem:a776f35f97f4e03bed1685798da2dca92" id="r_a776f35f97f4e03bed1685798da2dca92"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a776f35f97f4e03bed1685798da2dca92">startTime</a></td></tr>
<tr class="memitem:aa57020f6115c1f3bb322d9f3fd01fcba" id="r_aa57020f6115c1f3bb322d9f3fd01fcba"><td class="memItemLeft" align="right" valign="top">byte&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa57020f6115c1f3bb322d9f3fd01fcba">AUTH_UID</a> [] = { 0x04, 0x81, 0x70, 0x0A, 0x9C, 0x14, 0x90 }</td></tr>
<tr class="memdesc:aa57020f6115c1f3bb322d9f3fd01fcba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authorized UID for RFID access.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ESP32 BLE Central with RFID and LCD UI. </p>
<p>This sketch implements an ESP32 BLE central device that:</p><ul>
<li>Scans and connects to a BLE peripheral (with Button + IMU characteristics)</li>
<li>Estimates distance from RSSI using a path-loss model</li>
<li>Displays IMU movement state and distance on an I2C LCD</li>
<li>Uses FreeRTOS tasks for concurrency (scanner, distance calc, UI, button, RFID, reset)</li>
<li>Integrates RC522 RFID for access control, requiring authorized UID</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Uses ESP32 Arduino Core 3.x (NimBLE backend). </dd></dl>
<dl class="section author"><dt>Author</dt><dd>George Evans Daenuwy &amp; Rasya Fawwaz </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-08-21 </dd></dl>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="afe874f71a08a3f462cb89a768e2a43e2" name="afe874f71a08a3f462cb89a768e2a43e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe874f71a08a3f462cb89a768e2a43e2">&#9670;&#160;</a></span>BUTTON_CHAR_UUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUTTON_CHAR_UUID&#160;&#160;&#160;&quot;b51bd845-2910-4f84-b062-d297ed286b1f&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Button characteristic UUID </p>

</div>
</div>
<a id="ab61d0981ed42df9e18211b273d22cfcd" name="ab61d0981ed42df9e18211b273d22cfcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab61d0981ed42df9e18211b273d22cfcd">&#9670;&#160;</a></span>BUZZER_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUZZER_PIN&#160;&#160;&#160;42</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GPIO pin for buzzer/button </p>

</div>
</div>
<a id="ad5ef132e7e580fbe574f6cf357becb2e" name="ad5ef132e7e580fbe574f6cf357becb2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5ef132e7e580fbe574f6cf357becb2e">&#9670;&#160;</a></span>IMU_CHAR_UUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMU_CHAR_UUID&#160;&#160;&#160;&quot;0679c389-0d92-4604-aac4-664c43a51934&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IMU characteristic UUID </p>

</div>
</div>
<a id="a46bdd417480dec5cb9cf196af3c7489c" name="a46bdd417480dec5cb9cf196af3c7489c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46bdd417480dec5cb9cf196af3c7489c">&#9670;&#160;</a></span>PIN_MISO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_MISO&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RC522 MISO pin </p>

</div>
</div>
<a id="abaeddda4b992af7165ed898ab8b2b4ac" name="abaeddda4b992af7165ed898ab8b2b4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaeddda4b992af7165ed898ab8b2b4ac">&#9670;&#160;</a></span>PIN_MOSI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_MOSI&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RC522 MOSI pin </p>

</div>
</div>
<a id="a0010d60e4eaa7f589cd190c45dcc7d20" name="a0010d60e4eaa7f589cd190c45dcc7d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0010d60e4eaa7f589cd190c45dcc7d20">&#9670;&#160;</a></span>PIN_RST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_RST&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RC522 reset </p>

</div>
</div>
<a id="a6a1a3e97267377d1b18bb9073192fdf1" name="a6a1a3e97267377d1b18bb9073192fdf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1a3e97267377d1b18bb9073192fdf1">&#9670;&#160;</a></span>PIN_SCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_SCK&#160;&#160;&#160;13</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RC522 SCK pin </p>

</div>
</div>
<a id="ab4b553591a495409d4f7cec4b6c3e754" name="ab4b553591a495409d4f7cec4b6c3e754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b553591a495409d4f7cec4b6c3e754">&#9670;&#160;</a></span>PIN_SS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_SS&#160;&#160;&#160;14</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RC522 chip select (SDA/SS) </p>

</div>
</div>
<a id="a08bca59db4b190eaaea4d47b7562869c" name="a08bca59db4b190eaaea4d47b7562869c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08bca59db4b190eaaea4d47b7562869c">&#9670;&#160;</a></span>RESET_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESET_PIN&#160;&#160;&#160;41</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GPIO pin for reset button </p>

</div>
</div>
<a id="a326fc861b95f600798f492bd65a5caed" name="a326fc861b95f600798f492bd65a5caed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326fc861b95f600798f492bd65a5caed">&#9670;&#160;</a></span>RFID_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RFID_PIN&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GPIO pin for RFID buzzer </p>

</div>
</div>
<a id="a445125ee8c34695376c85f10b38844d6" name="a445125ee8c34695376c85f10b38844d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a445125ee8c34695376c85f10b38844d6">&#9670;&#160;</a></span>SERVICE_UUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERVICE_UUID&#160;&#160;&#160;&quot;275dc6e0-dff5-4b56-9af0-584a5768a02a&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; BLE core (ESP32 Arduino core 3.x uses NimBLE backend) &lt; I2C LCD library &lt; I2C bus &lt; SPI bus &lt; RFID RC522 driver &lt; Custom BLE scanning logic &lt; Distance estimation from RSSI Service UUID </p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a366bf7d724e74382df3a70cbfcf4cf9d" name="a366bf7d724e74382df3a70cbfcf4cf9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a366bf7d724e74382df3a70cbfcf4cf9d">&#9670;&#160;</a></span>BLEScannerTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BLEScannerTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to scan for BLE peripherals. </p>
<p>BLE scanner task.</p>
<ul>
<li>Initializes BLE central</li>
<li>Scans for peripherals advertising the target service UUID</li>
<li>Connects and auto-reconnects if disconnected</li>
<li>Periodically reads RSSI and sends to RSSI queue </li>
</ul>

</div>
</div>
<a id="a1f2482e5e4403590a79f1bb1eaedcbea" name="a1f2482e5e4403590a79f1bb1eaedcbea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f2482e5e4403590a79f1bb1eaedcbea">&#9670;&#160;</a></span>buttonTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buttonTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to handle button input. </p>
<p>Button task.</p>
<ul>
<li>Reads button press with debouncing</li>
<li>Sends state via BLE </li>
</ul>

</div>
</div>
<a id="ace8b2fe642b7289d51edb712ab27f86b" name="ace8b2fe642b7289d51edb712ab27f86b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace8b2fe642b7289d51edb712ab27f86b">&#9670;&#160;</a></span>distanceTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void distanceTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to compute distance from RSSI. </p>
<p>Distance estimation task.</p>
<ul>
<li>Consumes RSSI values</li>
<li>Smooths RSSI</li>
<li>Converts to distance estimate</li>
<li>Sends result to distance queue </li>
</ul>

</div>
</div>
<a id="ada1331884e2cfbe181532b4833c2bb78" name="ada1331884e2cfbe181532b4833c2bb78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada1331884e2cfbe181532b4833c2bb78">&#9670;&#160;</a></span>isAuthorized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isAuthorized </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if RFID UID is authorized. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>if UID matches AUTH_UID </td></tr>
    <tr><td class="paramname">false</td><td>otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae084e1bc8ccb35ea289ba0ca4972ea6d" name="ae084e1bc8ccb35ea289ba0ca4972ea6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae084e1bc8ccb35ea289ba0ca4972ea6d">&#9670;&#160;</a></span>lcd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LiquidCrystal_I2C lcd </td>
          <td>(</td>
          <td class="paramtype">0x27</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">16</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">2</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>I2C LCD (16x2) </p>

</div>
</div>
<a id="a78aea0b783dee7e793220e19bf94eea9" name="a78aea0b783dee7e793220e19bf94eea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78aea0b783dee7e793220e19bf94eea9">&#9670;&#160;</a></span>resetButtonTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resetButtonTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to reset RFID and lock system. </p>
<p>Reset button task.</p>
<ul>
<li>Debounced reset button input</li>
<li>Resets RFID and locks system</li>
<li>Suspends UI and button tasks </li>
</ul>

</div>
</div>
<a id="a7c2f79e6d9d3ac306c0daed213e162a4" name="a7c2f79e6d9d3ac306c0daed213e162a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2f79e6d9d3ac306c0daed213e162a4">&#9670;&#160;</a></span>rfid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MFRC522 rfid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#ab4b553591a495409d4f7cec4b6c3e754">PIN_SS</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a0010d60e4eaa7f589cd190c45dcc7d20">PIN_RST</a></td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RFID reader instance </p>

</div>
</div>
<a id="ab3b8593e304b021095698adac2b7f217" name="ab3b8593e304b021095698adac2b7f217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3b8593e304b021095698adac2b7f217">&#9670;&#160;</a></span>RFIDTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RFIDTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to handle RFID scanning and authorization. </p>
<p>RFID task.</p>
<ul>
<li>Waits for RFID card</li>
<li>Prints UID to Serial</li>
<li>Grants access if authorized</li>
<li>Resumes UI and button tasks on success </li>
</ul>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d" name="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Arduino setup function. Initializes queues, peripherals, tasks, and starts FreeRTOS. </p>

</div>
</div>
<a id="ae38cff9bb8d4b8b7bfff8fb8b68ffb77" name="ae38cff9bb8d4b8b7bfff8fb8b68ffb77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae38cff9bb8d4b8b7bfff8fb8b68ffb77">&#9670;&#160;</a></span>UITask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UITask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to update LCD UI. </p>
<p>UI task.</p>
<ul>
<li>Displays distance and movement state on LCD</li>
<li>Consumes from IMUQ and distance queue </li>
</ul>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="aa57020f6115c1f3bb322d9f3fd01fcba" name="aa57020f6115c1f3bb322d9f3fd01fcba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa57020f6115c1f3bb322d9f3fd01fcba">&#9670;&#160;</a></span>AUTH_UID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte AUTH_UID[] = { 0x04, 0x81, 0x70, 0x0A, 0x9C, 0x14, 0x90 }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authorized UID for RFID access. </p>

</div>
</div>
<a id="a2da550aadcbf5e6024b7395ad66fbcd2" name="a2da550aadcbf5e6024b7395ad66fbcd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2da550aadcbf5e6024b7395ad66fbcd2">&#9670;&#160;</a></span>ButtonTaskHandle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t ButtonTaskHandle</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle for button task </p>

</div>
</div>
<a id="aaa747d1be9fe26dc539f6b760aa40577" name="aaa747d1be9fe26dc539f6b760aa40577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa747d1be9fe26dc539f6b760aa40577">&#9670;&#160;</a></span>disQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t disQ</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Queue for distance values </p>

</div>
</div>
<a id="a36a62ed2995d8a4c80ea910f4e62c792" name="a36a62ed2995d8a4c80ea910f4e62c792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36a62ed2995d8a4c80ea910f4e62c792">&#9670;&#160;</a></span>IMUQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t IMUQ</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Queue for IMU moving flag </p>

</div>
</div>
<a id="a7bc035b6b02d12aad4f989c47ce95ce3" name="a7bc035b6b02d12aad4f989c47ce95ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bc035b6b02d12aad4f989c47ce95ce3">&#9670;&#160;</a></span>RFIDTaskHandle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t RFIDTaskHandle</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle for RFID task </p>

</div>
</div>
<a id="afc318e3b04b7bf8f6fecc08ac6a0a39a" name="afc318e3b04b7bf8f6fecc08ac6a0a39a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc318e3b04b7bf8f6fecc08ac6a0a39a">&#9670;&#160;</a></span>RSSIQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t RSSIQ</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Queue for RSSI values </p>

</div>
</div>
<a id="a776f35f97f4e03bed1685798da2dca92" name="a776f35f97f4e03bed1685798da2dca92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776f35f97f4e03bed1685798da2dca92">&#9670;&#160;</a></span>startTime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t startTime</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Timer for RSSI sampling </p>

</div>
</div>
<a id="a8e83540e3203f0d452453786a5911874" name="a8e83540e3203f0d452453786a5911874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e83540e3203f0d452453786a5911874">&#9670;&#160;</a></span>uiSet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueSetHandle_t uiSet = nullptr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Queue set for UI multiplexing </p>

</div>
</div>
<a id="a467e28ac5652806c01ab750112413fb1" name="a467e28ac5652806c01ab750112413fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a467e28ac5652806c01ab750112413fb1">&#9670;&#160;</a></span>UITaskHandle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaskHandle_t UITaskHandle</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle for UI task </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_02b1a89c2d2186e4810ecb7fecaa3754.html">scanner</a></li><li class="navelem"><a href="scanner_8ino.html">scanner.ino</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
